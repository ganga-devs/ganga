from GangaLHCb.test import *

addLocalTestSubmitter()

datafile = 'LFN:/lhcb/production/DC06/phys-v2-lumi2/00001694/DST/0000/00001694_00000001_5.dst'

data = []
for f in range(0,20000): data.append(datafile)

j = Job(application=DaVinci(), backend=TestSubmitter(time=1))
j.splitter=SplitByFiles(filesPerJob=100)
j.inputdata = data

j.submit()

assert(len(j.subjobs)==200)
for s in range(0,200):
    assert(len(j.subjobs[s].inputdata.files)==100)

# don't need to assert much, it just shouldn't time out (set to 5 minutes)
