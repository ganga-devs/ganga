import os, tempfile, sys

j = Job(backend = Dirac())

lfns = ['/lhcb/production/DC06/phys-v2-lumi2/00001889/DST/0000/00001889_00000003_5.dst','/foo/bar/doesnt_exist.dst']

tmpdir = tempfile.mktemp()
os.mkdir(tmpdir)

output = j.backend.getOutputData(dir = tmpdir, names = lfns)

assert len(output) == 1, 'Only one file should have been downloaded - %s' % output

outfile = os.path.join(tmpdir,os.path.basename(lfns[0]))
assert outfile in output, 'File should be reported in the correct place'
assert os.path.exists(outfile), 'File should exist'

#clean up
os.unlink(outfile)
os.rmdir(tmpdir)